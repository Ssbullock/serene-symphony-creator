import{F as m,j as t,f as B,G as A,v as G,H as R,r as x,I as y,J as h}from"./index-X57gThh1.js";import{L as N}from"./label-DPXlWjO2.js";import{I as C}from"./input-gHlei2MB.js";import{B as P}from"./button-BtdOMsSr.js";var D={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},S=m.createContext&&m.createContext(D),M=["attr","size","title"];function W(e,r){if(e==null)return{};var a=k(e,r),n,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)n=d[c],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function k(e,r){if(e==null)return{};var a={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(r.indexOf(n)>=0)continue;a[n]=e[n]}return a}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},b.apply(this,arguments)}function I(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,n)}return a}function v(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?I(Object(a),!0).forEach(function(n){H(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))})}return e}function H(e,r,a){return r=V(r),r in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function V(e){var r=T(e,"string");return typeof r=="symbol"?r:r+""}function T(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var n=a.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function E(e){return e&&e.map((r,a)=>m.createElement(r.tag,v({key:a},r.attr),E(r.child)))}function $(e){return r=>m.createElement(J,b({attr:v({},e.attr)},r),E(e.child))}function J(e){var r=a=>{var{attr:n,size:c,title:d}=e,p=W(e,M),u=c||a.size||"1em",s;return a.className&&(s=a.className),e.className&&(s=(s?s+" ":"")+e.className),m.createElement("svg",b({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,n,p,{className:s,style:v(v({color:e.color||a.color},a.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),d&&m.createElement("title",null,d),e.children)};return S!==void 0?m.createElement(S.Consumer,null,a=>r(a)):r(D)}function q(e){return $({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`},child:[]},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`},child:[]},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`},child:[]},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`},child:[]}]})(e)}const K=A("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Y({className:e,variant:r,...a}){return t.jsx("div",{className:B(K({variant:r}),e),...a})}const te=()=>{const e=G(),[r]=R(),a=r.get("redirect"),n=r.get("mode"),[c,d]=x.useState(!1),[p,u]=x.useState(!1),[s,U]=x.useState(n!=="login"),[i,z]=x.useState({email:"",password:"",name:""}),O=o=>a?`${decodeURIComponent(a)}?prefilled_email=${encodeURIComponent(o)}`:null,w=o=>{z({...i,[o.target.name]:o.target.value})},F=()=>{const o=s?"login":"signup",l=new URLSearchParams(r);l.set("mode",o),e(`/auth?${l.toString()}`),U(!s)},_=async()=>{try{u(!0);const{error:o}=await y.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});if(o)throw o}catch(o){h.error(o.message||"Google authentication failed"),console.error("Google auth error:",o)}finally{u(!1)}},L=async o=>{if(o.preventDefault(),!i.email||!i.password||s&&!i.name){h.error("Please fill out all fields");return}try{if(d(!0),s){const{data:l,error:g}=await y.auth.signUp({email:i.email,password:i.password,options:{data:{name:i.name},emailRedirectTo:void 0}});if(g)throw g;if(l.user){const{error:j}=await y.from("users").upsert([{id:l.user.id,email:l.user.email,name:i.name,auth_id:l.user.id,last_login_at:new Date().toISOString()}],{onConflict:"id",ignoreDuplicates:!1});if(j)throw console.error("Error creating user profile:",j),j}h.success("Account created successfully!");const f=O(i.email);f?window.location.href=f:e("/dashboard")}else{const{data:l,error:g}=await y.auth.signInWithPassword({email:i.email,password:i.password});if(g)throw g;h.success("Logged in successfully!");const f=O(i.email);f?window.location.href=f:e("/dashboard")}}catch(l){h.error(l.message||"Authentication failed"),console.error("Auth error:",l)}finally{d(!1)}};return t.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gradient-to-br from-meditation-light-blue to-white",children:t.jsxs("div",{className:"w-full max-w-md mx-auto",children:[t.jsxs("div",{className:"flex flex-col items-center mb-8",children:[t.jsxs("div",{className:"relative h-20 w-20 mb-4",children:[t.jsx("div",{className:"absolute inset-0 bg-meditation-calm-blue rounded-full animate-breathe opacity-20"}),t.jsx("div",{className:"absolute inset-2 bg-meditation-calm-blue rounded-full animate-breathe opacity-40",style:{animationDelay:"0.5s"}}),t.jsx("div",{className:"absolute inset-4 bg-meditation-calm-blue rounded-full animate-breathe opacity-60",style:{animationDelay:"1s"}}),t.jsx("div",{className:"absolute inset-6 bg-meditation-calm-blue rounded-full animate-breathe opacity-80",style:{animationDelay:"1.5s"}})]}),t.jsx("h1",{className:"text-3xl font-semibold tracking-wide text-gray-900 mb-2",children:"Serene"}),t.jsx("p",{className:"text-xl text-gray-600",children:"Breathe in. Breathe out. Begin."})]}),t.jsxs("div",{className:"bg-white/90 rounded-lg shadow-lg p-8 border border-gray-100 backdrop-blur-sm glass-card",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:s?"Create an account":"Welcome back"}),t.jsx(Y,{variant:"secondary",className:"bg-meditation-calm-blue/10 text-meditation-deep-blue",children:s?"New User":"Login"})]}),t.jsxs("form",{onSubmit:L,className:"space-y-5",children:[s&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(N,{htmlFor:"name",className:"text-gray-800 font-medium",children:"Full Name"}),t.jsx(C,{id:"name",name:"name",type:"text",placeholder:"Your name",value:i.name,onChange:w,className:"transition-all duration-300 focus:ring-primary bg-white text-gray-800 placeholder:text-gray-500 border-gray-200"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(N,{htmlFor:"email",className:"text-gray-800 font-medium",children:"Email"}),t.jsx(C,{id:"email",name:"email",type:"email",placeholder:"your.email@example.com",value:i.email,onChange:w,className:"transition-all duration-300 focus:ring-primary bg-white text-gray-800 placeholder:text-gray-500 border-gray-200"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(N,{htmlFor:"password",className:"text-gray-800 font-medium",children:"Password"}),t.jsx(C,{id:"password",name:"password",type:"password",placeholder:"••••••••",value:i.password,onChange:w,className:"transition-all duration-300 focus:ring-primary bg-white text-gray-800 placeholder:text-gray-500 border-gray-200"})]}),t.jsx(P,{type:"submit",disabled:c,className:"w-full py-3 px-4 btn-primary-gradient",children:c?t.jsxs("span",{className:"flex items-center justify-center",children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):s?"Sign Up":"Log In"})]}),t.jsxs("div",{className:"relative my-6",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("div",{className:"w-full border-t border-gray-200"})}),t.jsx("div",{className:"relative flex justify-center text-sm",children:t.jsx("span",{className:"px-2 bg-white text-gray-500 font-medium",children:"Or continue with"})})]}),t.jsx(P,{type:"button",onClick:_,disabled:p,variant:"outline",className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-white hover:bg-gray-50 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-800 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors duration-300",children:p?t.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"h-5 w-5"}),t.jsx("span",{children:"Sign in with Google"})]})}),t.jsx("div",{className:"mt-6 text-center",children:t.jsx("button",{onClick:F,className:"text-primary hover:text-primary/80 hover:underline focus:outline-none transition-colors font-medium",children:s?"Already have an account? Log in":"Need an account? Sign up"})})]})]})})};export{te as default};
